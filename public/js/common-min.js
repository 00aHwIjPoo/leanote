function trimLeft(a,b){if(!b||" "==b)return $.trim(a);for(;0==a.indexOf(b);)a=a.substring(b.length);return a}function json(str){return eval("("+str+")")}function t(){var a=arguments;if(a.length<=1)return a[0];var b=a[0];if(!b)return b;var c="LEAAEL";b=b.replace(/\?/g,c);for(var d=1;d<=a.length;++d)b=b.replace(c,a[d]);return b}function arrayEqual(a,b){return a=a||[],b=b||[],a.join(",")==b.join(",")}function isArray(a){return"[object Array]"===Object.prototype.toString.call(a)}function isEmpty(a){return a?isArray(a)&&0==a.length?!0:!1:!0}function getFormJsonData(a){var b=formArrDataToJson($("#"+a).serializeArray());return b}function formArrDataToJson(a){var b={},c={};for(var d in a){var e=a[d].name,f=a[d].value;"[]"!=e.substring(e.length-2,e.length)?b[e]=f:(e=e.substring(0,e.length-2),void 0==c[e]?c[e]=[f]:c[e].push(f))}return $.extend(b,c)}function formSerializeDataToJson(a){for(var b=a.split("&"),c={},d={},e=0;e<b.length;++e){var f=b[e].split("="),g=decodeURI(f[0]),h=decodeURI(f[1]);"[]"!=g.substring(g.length-2,g.length)?c[g]=h:(g=g.substring(0,g.length-2),void 0==d[g]?d[g]=[h]:d[g].push(h))}return $.extend(c,d)}function _ajaxCallback(a,b,c){if(a===!0||"true"==a||"object"==typeof a){if(a&&"object"==typeof a&&"NOTLOGIN"==a.Msg)return alert("\u4f60\u8fd8\u6ca1\u6709\u767b\u5f55, \u8bf7\u5148\u767b\u5f55!"),void 0;"function"==typeof b&&b(a)}else"function"==typeof c?c(a):alert("error!")}function _ajax(a,b,c,d,e,f){return log("-------------------ajax:"),log(b),log(c),f="undefined"==typeof f?!0:!1,$.ajax({type:a,url:b,data:c,async:f,success:function(a){_ajaxCallback(a,d,e)},error:function(a){_ajaxCallback(a,d,e)}})}function ajaxGet(a,b,c,d,e){return _ajax("GET",a,b,c,d,e)}function ajaxPost(a,b,c,d,e){_ajax("POST",a,b,c,d,e)}function ajaxPostJson(a,b,c,d,e){log("-------------------ajaxPostJson:"),log(a),log(b),e="undefined"==typeof e?!0:!1,$.ajax({url:a,type:"POST",contentType:"application/json; charset=utf-8",datatype:"json",async:e,data:JSON.stringify(b),success:function(a){_ajaxCallback(a,c,d)},error:function(a){_ajaxCallback(a,c,d)}})}function findParents(a,b){if($(a).is(b))return $(a);for(var c=$(a).parents(),d=0;d<c.length;++d)if(log(c.eq(d)),c.eq(d).is(b))return c.seq(d);return null}function editorIframeTabindex(a){var b=$("#editorContent_ifr");0==b.size()?setTimeout(function(){editorIframeTabindex(a)},100):b.attr("tabindex",a)}function switchEditor(a){LEA.isM=a,a?($("#mdEditor").css("z-index",3).show(),editorIframeTabindex(3),$("#wmd-input").attr("tabindex",2),$("#leanoteNav").hide()):($("#editor").show(),$("#mdEditor").css("z-index",1),editorIframeTabindex(2),$("#wmd-input").attr("tabindex",3),$("#leanoteNav").show())}function setEditorContent(a,b,c){if(a||(a=""),b)$("#wmd-input").val(a),$("#wmd-preview").html(""),!a||c?($("#wmd-preview").html(c).css("height","auto"),ScrollLink&&ScrollLink.onPreviewFinished()):MarkdownEditor?($("#wmd-preview").html(previewToken+"<div style='text-align:center; padding: 10px 0;'><img src='http://leanote.com/images/loading-24.gif' /> \u6b63\u5728\u8f6c\u6362...</div>"),MarkdownEditor.refreshPreview()):setTimeout(function(){setEditorContent(a,!0,c)},200);else if($("#editorContent").html(a),"undefined"!=typeof tinymce&&tinymce.activeEditor){var d=tinymce.activeEditor;d.setContent(a),d.undoManager.clear()}else setTimeout(function(){setEditorContent(a,!1)},100)}function previewIsEmpty(a){return a&&a.substr(0,previewToken.length)!=previewToken?!1:!0}function getEditorContent(a){if(a)return[$("#wmd-input").val(),$("#wmd-preview").html()];var b=tinymce.activeEditor;if(b){var c=$(b.getBody());if(c.find("pinit").remove(),c.find(".thunderpin").remove(),c.find(".pin").parent().remove(),c=$(c).html())for(;;){var d=c.lastIndexOf("</script>");if(-1==d)return c;var e=c.length;if(e-9!=d)return c;var f=c.lastIndexOf("<script ");if(-1==f&&(f=c.lastIndexOf("<script>")),-1==f)return c;c=c.substring(0,f)}return c}}function disableEditor(){var a=tinymce.activeEditor;a&&(a.hide(),LEA.editorStatus=!1,$("#mceTollbarMark").show().css("z-index",1e3))}function enableEditor(){if(!LEA.editorStatus){$("#mceTollbarMark").css("z-index",-1).hide();var a=tinymce.activeEditor;a&&a.show()}}function showDialog(a,b){$("#leanoteDialog #modalTitle").html(b.title),$("#leanoteDialog .modal-body").html($("#"+a+" .modal-body").html()),$("#leanoteDialog .modal-footer").html($("#"+a+" .modal-footer").html()),delete b.title,b.show=!0,$("#leanoteDialog").modal(b)}function hideDialog(a){a||(a=0),setTimeout(function(){$("#leanoteDialog").modal("hide")},a)}function closeDialog(){$(".modal").modal("hide")}function showDialog2(a,b){b=b||{},b.show=!0,$(a).modal(b)}function hideDialog2(a,b){b||(b=0),setTimeout(function(){$(a).modal("hide")},b)}function showDialogRemote(a,b){b=b||{},a+="?";for(var c in b)a+=c+"="+b[c]+"&";$("#leanoteDialogRemote").modal({remote:a})}function hideDialogRemote(a){a?setTimeout(function(){$("#leanoteDialogRemote").modal("hide")},a):$("#leanoteDialogRemote").modal("hide")}function notifyInfo(a){$.pnotify({title:"\u901a\u77e5",text:a,type:"info",styling:"bootstrap"})}function notifyError(a){$.pnotify.defaults.delay=2e3,$.pnotify({title:"\u901a\u77e5",text:a,type:"error",styling:"bootstrap"})}function notifySuccess(a){$.pnotify({title:"\u901a\u77e5",text:a,type:"success",styling:"bootstrap"})}function goNowToDatetime(a){return a?a.substr(0,10)+" "+a.substr(11,8):""}function getCurDate(){return(new Date).format("yyyy-M-d")}function enter(a,b,c){a||(a="body"),$(a).on("keydown",b,function(a){13==a.keyCode&&c.call(this)})}function enterBlur(a,b){a||(a="body"),b||(b=a,a="body"),$(a).on("keydown",b,function(a){13==a.keyCode&&$(this).trigger("blur")})}function getObjectId(){return ObjectId()}function resizeEditor(){var b=$("#editorContent_ifr").parent();b.css("overflow","auto");var c=$("#editorContent").height();b.height(c),$("#editorContent_ifr").height(c)}function showMsg(a,b){$("#msg").html(a),b&&setTimeout(function(){$("#msg").html("")},b)}function showMsg2(a,b,c){$(a).html(b),c&&setTimeout(function(){$(a).html("")},c)}function showAlert(a,b,c,d){$(a).html(b).removeClass("alert-danger").removeClass("alert-success").removeClass("alert-warning").addClass("alert-"+c).show(),d&&$(d).focus()}function hideAlert(a,b){b?setTimeout(function(){$(a).hide()},b):$(a).hide()}function post(a,b,c,d){d&&$(d).button("loading"),ajaxPost(a,b,function(a){d&&$(d).button("reset"),"object"==typeof a?"function"==typeof c&&c(a):alert("leanote\u51fa\u73b0\u4e86\u9519\u8bef!")})}function isEmail(a){var b=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[0-9a-zA-Z]{2,3}$/;return b.test(a)}function isEmailFromInput(a,b,c,d){var e=$(a).val(),f=function(){};if(b&&(f=function(b,c){showAlert(b,c,"danger",a)}),e){if(isEmail(e))return e;f(b,d||getMsg("errorEmail"))}else f(b,c||getMsg("inputEmail"))}function initCopy(a,b){var c=new ZeroClipboard(document.getElementById(a),{moviePath:"/js/ZeroClipboard/ZeroClipboard.swf"});c.on("complete",function(a,c){b(c)})}function showLoading(){$("#loading").css("visibility","visible")}function hideLoading(){$("#loading").css("visibility","hidden")}function logout(){location.href=UrlPrefix+"/logout?id=1"}function getImageSize(a,b){function d(a,d){c.parentNode.removeChild(c),b({width:a,height:d})}var c=document.createElement("img");c.onload=function(){d(c.clientWidth,c.clientHeight)},c.onerror=function(){d()},c.src=a;var e=c.style;e.visibility="hidden",e.position="fixed",e.bottom=e.left=0,e.width=e.height="auto",document.body.appendChild(c)}function hiddenIframeBorder(){$(".mce-window iframe").attr("frameborder","no").attr("scrolling","no")}function getEmailLoginAddress(a){if(a){var b=a.split("@");if(b&&!(b.length<2)){var c=b[1];return email2LoginAddress[c]||"http://mail."+c}}}function reIsOk(a){return a&&"object"==typeof a&&a.Ok}function saveBookmark(){try{if(LEA.bookmark=tinymce.activeEditor.selection.getBookmark(),LEA.bookmark&&LEA.bookmark.id){var a=$($("#editorContent_ifr").contents()),b=a.find("body"),c=b.children().eq(0);if(c.is("span")){var d=c,e=d.eq(0);e.attr("id")==LEA.bookmark.id+"_start"?(LEA.hasBookmark=!1,e.remove()):LEA.hasBookmark=!0}else if(c.is("p")){var d=c.children();if(1==d.length&&""==$.trim(c.text())){var e=d.eq(0);e.attr("id")==LEA.bookmark.id+"_start"?(LEA.hasBookmark=!1,c.remove()):LEA.hasBookmark=!0}else LEA.hasBookmark=!0}}}catch(f){}}function restoreBookmark(){try{if(LEA.hasBookmark){var a=tinymce.activeEditor;a.focus(),a.selection.moveToBookmark(LEA.bookmark)}}catch(b){}}var LEA={},Notebook={cache:{}},Note={cache:{}},Tag={},Notebook={},Share={},Mobile={},Converter,MarkdownEditor,ScrollLink,tt=t;LEA.isM=!1,LEA.isMarkdownEditor=function(){return LEA.isM};var previewToken="<div style='display: none'>FORTOKEN</div>";LEA.editorStatus=!0,$(function(){$.pnotify&&($.pnotify.defaults.delay=1e3)}),Date.prototype.format=function(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var c in b)new RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[c]:("00"+b[c]).substr((""+b[c]).length)));return a};var email2LoginAddress={"qq.com":"http://mail.qq.com","gmail.com":"http://mail.google.com","sina.com":"http://mail.sina.com.cn","163.com":"http://mail.163.com","126.com":"http://mail.126.com","yeah.net":"http://www.yeah.net/","sohu.com":"http://mail.sohu.com/","tom.com":"http://mail.tom.com/","sogou.com":"http://mail.sogou.com/","139.com":"http://mail.10086.cn/","hotmail.com":"http://www.hotmail.com","live.com":"http://login.live.com/","live.cn":"http://login.live.cn/","live.com.cn":"http://login.live.com.cn","189.com":"http://webmail16.189.cn/webmail/","yahoo.com.cn":"http://mail.cn.yahoo.com/","yahoo.cn":"http://mail.cn.yahoo.com/","eyou.com":"http://www.eyou.com/","21cn.com":"http://mail.21cn.com/","188.com":"http://www.188.com/","foxmail.coom":"http://www.foxmail.com"};LEA.bookmark=null,LEA.hasBookmark=!1;var vd={isInt:function(a){var b=/^0$|^[1-9]\d*$/;return result=b.test(a)},isNumeric:function(a){return $.isNumeric(a)},isFloat:function(a){var b=/^0(\.\d+)?$|^[1-9]\d*(\.\d+)?$/;return result=b.test(a)},isEmail:function(a){var b=/^[^@.]+@([^@.]+\.)+[^@.]+$/;return result=b.test(a)},isBlank:function(a){return!$.trim(a)},has_special_chars:function(a){return/['"#$%&\^<>\?*]/.test(a)},init:function(form,rule_funcs){function is_required(a){var b=get_name(a),c=get_rules(a,b),d=c[0];return"required"==d.rule?!0:!1}function get_rules(target,name){return rules[name]||(rules[name]=eval("("+target.data("rules")+")")),rules[name]}function get_msg_target(a,b){if(!msg_targets[b]){var c=a.data("msg_target");if(c)msg_targets[b]=$(c);else{var d=$('<div class="help-block alert alert-warning" style="display: block;"></div>');a.parent().append(d),msg_targets[b]=d}}return msg_targets[b]}function hide_msg(a,b){var c=get_msg_target(a,b);c.hasClass("alert-success")||c.hide()}function show_msg(a,b,c,d){var e=get_msg_target(a,b);e.html(getMsg(c,d)).removeClass("hide alert-success").addClass("alert-danger").show()}function pre_fix(a){var b=a.data("pre_fix");if(b)switch(b){case"int":int_fix(a);break;case"price":price_fix(a);break;case"decimal":decimal_fix(a)}}function apply_rules(a,b){var c=get_rules(a,b);if(pre_fix(a),!c)return!0;for(var d=0;d<c.length;++d){var e=c[d],f=e.rule,g=e.msg,h=e.msgData;if(!rule_funcs[f](a,e))return show_msg(a,b,g,h),!1}hide_msg(a,b);var i=a.data("post_rule");return i&&setTimeout(function(){var a=$(i);apply_rules(a,get_name(a))},0),!0}function focus_func(a){var b=$(a.target),c=get_name(b);hide_msg(b,c),pre_fix(b)}function unfocus_func(a){var b=$(a.target),c=get_name(b);apply_rules(b,c)}function get_name(a){return a.data("u_name")||a.attr("name")||a.attr("id")}var get_val=function(a){if(a.is(":checkbox")){var b=a.attr("name"),c=$('input[name="'+b+'"]:checked').length;return c}return a.is(":radio")?void 0:a.val()},default_rule_funcs={required:function(a){return get_val(a)},min:function(a,b){var c=get_val(a);return""!==c||is_required(a)?c<b.data?!1:!0:!0},minLength:function(a,b){var c=get_val(a);return""!==c||is_required(a)?c.length<b.data?!1:!0:!0},email:function(a){var c=get_val(a);return""!==c||is_required(a)?isEmail(c):!0},noSpecialChars:function(a){var b=get_val(a);return b?/[^0-9a-zzA-Z_\-]/.test(b)?!1:!0:!0},password:function(a){var c=get_val(a);return""!==c||is_required(a)?c.length>=6:!0},equalTo:function(a,b){var c=get_val(a);return""!==c||is_required(a)?$(b.data).val()==c:!0}};rule_funcs=rule_funcs||{},rule_funcs=$.extend(default_rule_funcs,rule_funcs);var rules={},msg_targets={},$allElems=$(form).find("[data-rules]"),$form=$(form);$form.on({keyup:function(a){13!=a.keyCode&&focus_func(a)},blur:unfocus_func},'input[type="text"], input[type="password"]'),$form.on({change:function(a){$(this).val()?focus_func(a):unfocus_func(a)}},"select"),$form.on({change:function(a){unfocus_func(a)}},'input[type="checkbox"]'),this.valid=function(){for(var a=$allElems,b=!0,c=0;c<a.length;++c){var d=a.eq(c),e=get_name(d);if(!apply_rules(d,e))return b=!1,d.focus(),!1}return b},this.validElement=function(a){for(var a=$(a),b=!0,c=0;c<a.length;++c){var d=a.eq(c),e=get_name(d);apply_rules(d,e)||(b=!1)}return b}}};